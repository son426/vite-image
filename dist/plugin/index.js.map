{"version":3,"sources":["../../src/plugin/index.ts"],"names":[],"mappings":";;;AAyBO,SAAS,UAAU,OAAA,EAAkD;AAE1E,EAAA,MAAM,cAAA,GAA+B;AAAA,IACnC,IAAA,EAAM,8BAAA;AAAA,IACN,OAAA,EAAS,KAAA;AAAA,IACT,MAAM,KAAK,EAAA,EAAY;AACrB,MAAA,MAAM,CAAC,QAAA,EAAU,MAAM,CAAA,GAAI,EAAA,CAAG,MAAM,GAAG,CAAA;AACvC,MAAA,MAAM,MAAA,GAAS,IAAI,eAAA,CAAgB,MAAM,CAAA;AAEzC,MAAA,IAAI,MAAA,CAAO,GAAA,CAAI,YAAY,CAAA,EAAG;AAC5B,QAAA,MAAM,YAAA,GAAe,uCAAA;AACrB,QAAA,MAAM,UAAA,GAAa,4BAAA;AACnB,QAAA,MAAM,UAAA,GAAa,2CAAA;AAEnB,QAAA,OAAO;AAAA,8BAAA,EACiB,QAAQ,IAAI,YAAY,CAAA;AAAA,4BAAA,EAC1B,QAAQ,IAAI,UAAU,CAAA;AAAA,+BAAA,EACnB,QAAQ,IAAI,UAAU,CAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAAA,CAAA;AAAA,MAWjD;AAEA,MAAA,OAAO,IAAA;AAAA,IACT;AAAA,GACF;AAEA,EAAA,OAAO,CAAC,cAAA,EAAgB,UAAA,CAAW,OAAO,CAAC,CAAA;AAC7C","file":"index.js","sourcesContent":["import type { PluginOption } from \"vite\";\nimport { imagetools } from \"vite-imagetools\";\n\nexport type ViteImagePluginOptions = Parameters<typeof imagetools>[0];\n\n/**\n * Vite plugin for image optimization using vite-imagetools\n * This plugin handles ?vite-image queries and uses imagetools for image processing\n *\n * @param options - Options to pass to vite-imagetools\n * @returns Array of Vite plugins (vite-image macro and imagetools)\n *\n * @example\n * ```ts\n * // vite.config.ts\n * import { defineConfig } from 'vite';\n * import { viteImage } from '@son426/vite-image/plugin';\n *\n * export default defineConfig({\n *   plugins: [\n *     ...viteImage(),\n *   ],\n * });\n * ```\n */\nexport function viteImage(options?: ViteImagePluginOptions): PluginOption[] {\n  // 커스텀 플러그인: ?vite-image 쿼리를 처리\n  const viteImageMacro: PluginOption = {\n    name: \"vite-plugin-vite-image-macro\",\n    enforce: \"pre\" as const,\n    async load(id: string) {\n      const [basePath, search] = id.split(\"?\");\n      const params = new URLSearchParams(search);\n\n      if (params.has(\"vite-image\")) {\n        const srcSetParams = \"w=640;1024;1920&format=webp&as=srcset\";\n        const metaParams = \"w=1920&format=webp&as=meta\";\n        const lqipParams = \"w=20&blur=2&quality=20&format=webp&inline\";\n\n        return `\n          import srcSet from \"${basePath}?${srcSetParams}\";\n          import meta from \"${basePath}?${metaParams}\";\n          import lqipSrc from \"${basePath}?${lqipParams}\";\n          \n          export default {\n            src: meta.src,\n            width: meta.width,\n            height: meta.height,\n            srcSet: srcSet,\n            lqipSrc: lqipSrc, // Deprecated: 하위 호환성을 위해 유지\n            blurDataURL: lqipSrc // Next.js Image 호환성을 위한 blurDataURL\n          };\n        `;\n      }\n\n      return null;\n    },\n  };\n\n  return [viteImageMacro, imagetools(options)];\n}\n"]}